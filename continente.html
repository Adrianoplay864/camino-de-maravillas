<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Carregando... - Camino de Maravillas</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <link rel="stylesheet" href="style.css" />
</head>
<body>
    <!-- Header -->
    <div id="header-container"></div>

    <!-- Hero do Continente -->
    <section class="hero hero-continente" id="hero-continente">
        <div class="container">
            <h1 id="continente-titulo" class="fade-in">Carregando...</h1>
            <p id="continente-descricao" class="fade-in delay-1"></p>
            <a href="#destinos" class="btn fade-in delay-2">Ver Destinos</a>
        </div>
    </section>

    <!-- Conteúdo do continente -->
    <section id="destinos" class="travel-section">
        <div class="container">
            <div class="section-header">
                <h3>DESTINOS</h3>
                <p id="destinos-subtitulo">Explore os melhores destinos deste continente</p>
            </div>

            <!-- Grid de subdestinos -->
            <div class="destinations-grid" id="subdestinos-container">
                <!-- Carregado dinamicamente -->
            </div>
        </div>
    </section>

    <!-- Footer -->
    <div id="footer-container"></div>

    <!-- Scripts -->
    <script src="common.js"></script>
    <script>
        // Carregar componentes
        document.addEventListener("DOMContentLoaded", () => {
            loadComponent("header-container", "header.html")
                .then(() => initializeHeader());
            
            loadComponent("footer-container", "footer.html");
            
            // Carregar dados do continente
            loadContinente();
        });

        // Função principal para carregar dados do continente
        async function loadContinente() {
            const slug = getQueryParam("continente");

            if (!slug) {
                window.location.href = "index.html";
                return;
            }

            try {
                const response = await fetch("destinos.json");
                const data = await response.json();

                const continente = data.continentes.find(c => c.slug === slug);

                if (!continente) {
                    window.location.href = "index.html";
                    return;
                }

                // Atualizar página
                document.title = `${continente.nome} - Camino de Maravillas`;
                document.getElementById("continente-titulo").textContent = continente.nome;
                document.getElementById("continente-descricao").textContent = continente.descricao;
                document.getElementById("hero-continente").style.backgroundImage = 
                    `url('${continente.imagem}')`;
                
                // Carregar subdestinos
                const container = document.getElementById("subdestinos-container");
                
                if (continente.subdestinos && continente.subdestinos.length > 0) {
                    continente.subdestinos.forEach((subdestino, index) => {
                        const card = document.createElement("div");
                        card.className = `destination-card fade-in delay-${index % 3}`;
                        
                        card.innerHTML = `
                            <a href="destino.html?continente=${continente.slug}&destino=${subdestino.slug}">
                                <div class="destination-img" style="background-image: url('${subdestino.imagem}');">
                                </div>
                            </a>
                            <div class="destination-info">
                                <h3><a href="destino.html?continente=${continente.slug}&destino=${subdestino.slug}">${subdestino.nome}</a></h3>
                                <div class="card-actions">
                                    <a href="destino.html?continente=${continente.slug}&destino=${subdestino.slug}" class="btn btn-plano">
                                        Ver Pacotes
                                    </a>
                                    <a href="https://wa.me/573125493738?text=Olá! Gostaria de um orçamento para ${encodeURIComponent(subdestino.nome + ' - ' + continente.nome)}" 
                                       class="btn btn-whatsapp" target="_blank">
                                        <i class="fab fa-whatsapp"></i> Solicitar Orçamento
                                    </a>
                                </div>
                            </div>
                        `;
                        
                        container.appendChild(card);
                    });
                } else {
                    container.innerHTML = `
                        <div class="no-results" style="grid-column: 1 / -1; text-align: center; padding: 50px;">
                            <h3>Destinos em breve!</h3>
                            <p>Estamos preparando os melhores destinos para você.</p>
                            <a href="index.html" class="btn" style="margin-top: 20px;">
                                <i class="fas fa-arrow-left"></i> Voltar para Início
                            </a>
                        </div>
                    `;
                }
            } catch (error) {
                console.error("Erro ao carregar continente:", error);
                document.getElementById("subdestinos-container").innerHTML = `
                    <div class="error-message" style="grid-column: 1 / -1; text-align: center; padding: 50px;">
                        <h3>Erro ao carregar conteúdo</h3>
                        <p>Por favor, tente novamente mais tarde.</p>
                        <a href="index.html" class="btn" style="margin-top: 20px;">Voltar para Início</a>
                    </div>
                `;
            }
        }
    </script>
</body>
</html>